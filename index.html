<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heritage 3D Map</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Load PlayCanvas engine first -->
    <script src="https://cdn.jsdelivr.net/npm/playcanvas@1.59.0/build/playcanvas.min.js"></script>
    <!-- Then load Model Viewer plugin -->
    <script src="https://cdn.jsdelivr.net/gh/playcanvas/model-viewer@1.0.0/dist/model-viewer.min.js"></script>
</head>
<body>
    <div id="app-container">
        <div id="model-viewer"></div>
        <div id="loading">Loading viewer...</div>
    </div>

    <script>
        // Wait for all resources to load
        window.addEventListener('load', function() {
            const loadingElement = document.getElementById('loading');
            
            // Check if PlayCanvas and ModelViewer are loaded
            if (!window.pc || !pc.ModelViewer) {
                loadingElement.textContent = 'Error: Failed to load 3D viewer library';
                console.error('PlayCanvas or ModelViewer not loaded');
                return;
            }

            try {
                loadingElement.textContent = 'Initializing viewer...';
                
                const viewer = new pc.ModelViewer(document.getElementById('model-viewer'), {
                    assetsPrefix: './models/',
                    orbitSensitivity: 1.0,
                    enableUi: true
                });

                loadingElement.textContent = 'Loading model...';
                
                viewer.load('Kaplica_Zychlinskich.glb')
                    .then(function() {
                        loadingElement.style.display = 'none';
                        viewer.camera.orbitYaw = -30;
                        viewer.camera.orbitPitch = 75;
                        viewer.camera.distance = 10;
                    })
                    .catch(function(err) {
                        loadingElement.textContent = 'Error loading model';
                        console.error('Model load error:', err);
                    });

            } catch (error) {
                loadingElement.textContent = 'Initialization failed';
                console.error('Viewer initialization error:', error);
            }
        });
    </script>
</body>
</html>